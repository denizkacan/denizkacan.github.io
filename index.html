<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Music</title>

  <style>
    body{
  font-family: "MS Sans Serif", "Tahoma", system-ui, sans-serif;
  background: #008080; /* classic teal desktop */
  padding: 24px;
}

.player{
  max-width: 420px;
  background: #c0c0c0;
  border: 2px solid #000;
  box-shadow:
    2px 2px 0 #fff inset,
    -2px -2px 0 #808080 inset,
    6px 6px 0 rgba(0,0,0,0.25);
  padding: 12px;
}

#title{
  margin: 0 0 10px;
  padding: 6px 8px;
  background: #000080;   /* navy title bar */
  color: #fff;
  border: 2px solid #000;
  box-shadow:
    1px 1px 0 #fff inset,
    -1px -1px 0 #404040 inset;
  font-size: 14px;
}

#audio{
  width: 100%;
  margin-bottom: 10px;
}

#playlist{
  list-style: none;
  padding: 0;
  margin: 0;
  border: 2px solid #000;
  background: #fff;
  max-height: 220px;
  overflow: auto;
}

#playlist li{
  padding: 6px 8px;
  border-bottom: 1px solid #ddd;
  cursor: pointer;
  font-size: 13px;
}

#playlist li:hover{
  background: #000080;
  color: #fff;
}

#playlist li.active{
  background: #000;
  color: #00ff00; /* neon green */
}

  </style>
</head>

<body>
  <h1>ðŸŽ§ Music</h1>

  <div class="player">
  <h3 id="title">Loadingâ€¦</h3>
  <audio id="audio" controls preload="metadata"></audio>
  <ul id="playlist"></ul>
  </div>


  <script>
    const OWNER = "dkacan98";
    const REPO = "dkacan98.github.io";
    const BRANCH = "main";
    const AUDIO_PATH = "audio";
    const ALLOWED = [".mp3", ".m4a", ".ogg", ".wav"];

    const audio = document.getElementById("audio");
    const titleEl = document.getElementById("title");
    const playlistEl = document.getElementById("playlist");

    let tracks = [];
    let current = 0;

    function niceTitle(filename) {
      return filename
        .replace(/\.[^/.]+$/, "")
        .replace(/[_-]+/g, " ")
        .trim();
    }

    function loadTrack(i, autoplay = false) {
      current = i;
      audio.src = tracks[i].src;
      titleEl.textContent = tracks[i].title;

      [...playlistEl.children].forEach((li, idx) => {
        li.classList.toggle("active", idx === i);
      });

      if (autoplay) audio.play().catch(() => {});
    }

    function buildPlaylist() {
      playlistEl.innerHTML = "";
      tracks.forEach((t, i) => {
        const li = document.createElement("li");
        li.textContent = t.title;
        li.addEventListener("click", () => loadTrack(i, true));
        playlistEl.appendChild(li);
      });
      if (tracks.length) loadTrack(0, false);
    }

    audio.addEventListener("ended", () => {
      loadTrack((current + 1) % tracks.length, true);
    });

    async function fetchTracks() {
      const url = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${AUDIO_PATH}?ref=${BRANCH}`;
      const res = await fetch(url);
      if (!res.ok) throw new Error("Could not read audio folder");

      const items = await res.json();

      tracks = items
        .filter(x => x.type === "file")
        .map(x => x.name)
        .filter(name => ALLOWED.some(ext => name.toLowerCase().endsWith(ext)))
        .sort((a, b) => a.localeCompare(b))
        .map(name => ({
          title: niceTitle(name),
          src: `${AUDIO_PATH}/${encodeURIComponent(name)}`
        }));

      if (!tracks.length) {
        titleEl.textContent = "No audio files found";
        return;
      }

      buildPlaylist();
    }

    fetchTracks().catch(err => {
      console.error(err);
      titleEl.textContent = "Failed to load playlist";
    });
  </script>
</body>
</html>
